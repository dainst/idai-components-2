<form class="form-inline" id="search-bar">

    <input #searchInput
           [(ngModel)]="q"
           (keyup)="emitQueryStringWithTimeout()"
           name="searchInput"
           type="text"
           class="form-control"
           id="object-search"
           placeholder="Suchen...">

    <span class="input-group-btn" id="filter-button" *ngIf="showFiltersMenu">
        <button class="btn btn-primary"
                id="searchfilter"
                type="button"
                [ngbPopover]="filterMenu"
                #p="ngbPopover"
                placement="bottom">
            <span *ngIf="!type" class="mdi mdi-filter"></span>
            <span *ngIf="type">
                <type-icon [type]="type" size="30"></type-icon>
            </span>
        </button>

        <ng-template #filterMenu>
            <div class="filtermenu">
                <div class="popover-custom-title">Nach Ressourcentyp filtern:</div>
                <ul class="list-group">
                    <li id="choose-type-filter-option-all"
                        class="list-group-item popover-item"
                        (click)="setType(undefined); p.close();"
                        [ngClass]="{ 'selected-filter': !type || type == '' }">
                        <i>Alle Typen</i>
                    </li>

                    <li *ngFor="let filterType of filterOptions; let index = index"
                        id="choose-type-filter-option-{{index}}"
                        class="list-group-item popover-item"
                        (click)="setType(filterType.name); p.close();"
                        [ngClass]="{ 'selected-filter': type == filterType.name}">
                        <div>
                            <type-icon [type]="filterType.name" size="30"></type-icon>
                            <div class="type-label">{{filterType.label}}</div>
                        </div>
                        <ul *ngIf="filterType.children" style="padding: 0;">
                            <li *ngFor="let childType of filterType.children; let childIndex = index"
                                id="choose-type-filter-option-{{index}}-{{childIndex}}"
                                class="list-group-item popover-item"
                                (click)="setType(childType.name); p.close();"
                                [ngClass]="{ 'selected-filter': type == filterType.name || type == childType.name }">
                                <div>
                                    <type-icon [type]="childType.name" size="30"></type-icon>
                                    <div class="type-label">{{childType.label}}</div>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </ng-template>
    </span>
</form>